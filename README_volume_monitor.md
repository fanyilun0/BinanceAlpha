# Volume Monitor æ¨¡å—è¯´æ˜

## 1. æ ¸å¿ƒåŠŸèƒ½
æœ¬æ¨¡å— (`src/utils/volume_monitor.py`) ç”¨äºç›‘æ§åŠ å¯†è´§å¸å¸‚åœºçš„äº¤æ˜“é‡å˜åŒ–ï¼Œç»“åˆä»·æ ¼è¡Œä¸ºå’Œå†å²æ•°æ®ï¼ˆ3æ—¥è¶‹åŠ¿ï¼‰ï¼Œè¯†åˆ«ä¸»åŠ›èµ„é‡‘çš„å¸ç­¹ã€æ´—ç›˜å’Œå‡ºè´§è¡Œä¸ºã€‚

## 2. æ¨é€æ¶æ„ (Dual Stream Output)

é‡‡ç”¨ **åŒæµè¾“å‡º** æ¶æ„ï¼ŒåŸºäºç”¨æˆ·æ„å›¾è€Œéå½¢æ€åˆ†ç±»ï¼š

```mermaid
graph TD
    A[å¸‚åœºåŸå§‹æ•°æ®] --> B{ç¡¬æ€§å™ªéŸ³è¿‡æ»¤}
    B -->|å‰”é™¤| B1[MCap < 1M<br>Vol < 3M<br>Turnover < 2%]
    B -->|é€šè¿‡| C{åˆ†æå¼•æ“}
    
    C --> D[ä¸‰æ—¥è¶‹åŠ¿æ£€æµ‹]
    C --> E[åº„å®¶è¡Œä¸ºæ£€æµ‹]
    C --> F[äº¤æ˜“é‡å¼‚åŠ¨æ£€æµ‹]
    
    D & E & F --> G{SignalArbiter<br>èµ¢å®¶é€šåƒ}
    
    G -->|ä¼˜å…ˆçº§ 1| H[ğŸ¯ Alpha ä¿¡å·æµ]
    H --> H1[ç¨³å®šå¸ç­¹]
    H --> H2[æ´—ç›˜ç»“æŸ]
    H --> H3[ç‰›æ——æ•´ç†]
    H --> H4[å·¨é²¸å¸ç­¹]
    
    G -->|ä¼˜å…ˆçº§ 2| I[âš ï¸ å¼‚åŠ¨è­¦å‘Šæµ]
    I --> I1[ä¸»åŠ›å‡ºè´§]
    I --> I2[æç«¯çˆ†é‡]
    
    H & I --> J[ç´§å‡‘ Embed æ¨é€<br>æ¯ç±» Top 5]
```

## 3. æ¨é€ç±»åˆ« (ä»…ä¸¤ç±»)

### 3.1 ğŸ¯ Alpha ä¿¡å·æµ (High Confidence Long Setup)

> **ç”¨æˆ·æ„å›¾**: å¯»æ‰¾ä¹°å…¥/åšå¤šæœºä¼š

| å­ç±»å‹ | ç‰¹å¾ | é¢œè‰² |
|--------|------|------|
| ç¨³å®šå¸ç­¹ | è¿ç»­3æ—¥é‡èƒ½ç¨³å®š + ä»·æ ¼æ¨ªç›˜ | ç´«è‰² |
| æ´—ç›˜ç»“æŸ | è¿ç»­ç¼©é‡ + ä»·æ ¼ä¼ç¨³ | é»„è‰² |
| ç‰›æ——æ•´ç† | æ˜¨æ—¥æ”¾é‡å¤§æ¶¨ + ä»Šæ—¥ç¼©é‡å›è°ƒ | ç»¿è‰² |
| å·¨é²¸å¸ç­¹ | é«˜ç½®ä¿¡åº¦èµ„é‡‘æµå…¥ (Score â‰¥ 0.8) | è“è‰² |

### 3.2 âš ï¸ å¼‚åŠ¨è­¦å‘Šæµ (Anomalies & Risks)

> **ç”¨æˆ·æ„å›¾**: æŒä»“é¿é™©æˆ–æåº¦æŠ•æœº

| å­ç±»å‹ | ç‰¹å¾ | é¢œè‰² |
|--------|------|------|
| ä¸»åŠ›å‡ºè´§ | é‡å¢ä»·è·Œï¼Œæ˜æ˜¾å–å‡ºä¿¡å· | çº¢è‰² |
| æç«¯çˆ†é‡ | æç«¯äº¤æ˜“é‡å˜åŒ– (Vol â‰¥ 100%) | æ©™è‰² |

## 4. SignalArbiter å»é‡é€»è¾‘

é‡‡ç”¨ **"èµ¢å®¶é€šåƒ" (Winner Takes All)** ç­–ç•¥ï¼Œä¸€ä¸ªä»£å¸åªä¼šå‡ºç°åœ¨ä¸€ä¸ªåˆ†ç±»ä¸­ï¼š

**ä¼˜å…ˆçº§é¡ºåº:**
1. Trend (å®Œç¾ä¸‰æ—¥è¶‹åŠ¿) â†’ Alpha
2. Accumulation (å¼ºåŠ›å¸ç­¹, score > 0.8) â†’ Alpha
3. Distribution (å‡ºè´§) â†’ å¼‚åŠ¨
4. Extreme Vol (æç«¯æ³¢åŠ¨) â†’ å¼‚åŠ¨

## 5. ç¡¬æ€§è¿‡æ»¤é—¨æ§›

| è¿‡æ»¤ç»´åº¦ | é˜ˆå€¼ | è¯´æ˜ |
|----------|------|------|
| æœ€ä½å¸‚å€¼ | $1M | å‰”é™¤å¾®å‹ä»£å¸ |
| æœ€ä½äº¤æ˜“é‡ | $3M | ç¡®ä¿æµåŠ¨æ€§ |
| æœ€ä½æ¢æ‰‹ç‡ | 2% | å‰”é™¤æ­»ç›˜ |

## 6. Embed æ¶ˆæ¯æ ¼å¼

æ‰€æœ‰æ¨é€å‡ä½¿ç”¨ Discord Embed æ ¼å¼ï¼Œç´§å‡‘å±•ç¤ºï¼š

```
ğŸ¯ Alpha: æ´—ç›˜ç»“æŸ (5ä¸ª)
è¿ç»­ç¼©é‡ + ä»·æ ¼ä¼ç¨³ï¼Œå–ç›˜æ¯ç«­

1. FOLKS (Folks Finance)
ğŸ’µ $15.6 | ğŸ’° MC $177.9M | FDV $729.1M
Vol -49% ğŸ“‰ | Price +3.5% ğŸ“ˆ | 0.99 ğŸ”¥
[å¤§å¸‚å€¼ç¨³å¥] è¿ç»­ç¼©é‡(49.4%)ä¸”ä»·æ ¼ä¼ç¨³

2. SOON (SOON)
...
```

**å…³é”®ä¿¡æ¯ä¸€ç›®äº†ç„¶:**
- å½“å‰ä»·æ ¼ (æ–°å¢)
- å¸‚å€¼/FDV
- Vol/Price å˜åŒ–ç‡
- ç½®ä¿¡åº¦åˆ†æ•° + Emoji
- å¸‚å€¼æ ‡ç­¾ + ä¿¡å·åŸå› 

## 7. æ ¸å¿ƒç±»è¯´æ˜

### 7.1 SignalArbiter
ä¿¡å·ä»²è£å™¨ï¼Œå®ç°"èµ¢å®¶é€šåƒ"å»é‡é€»è¾‘ã€‚

```python
arbiter = SignalArbiter()
alpha_signals, anomaly_signals = arbiter.classify(
    trend_signals=trend_signals,
    accumulation_alerts=accumulation_alerts,
    distribution_alerts=distribution_alerts,
    volume_alerts=volume_alerts
)
```

### 7.2 ClassifiedSignal
åˆ†ç±»åçš„ä¿¡å·æ•°æ®ç»“æ„ï¼š

```python
@dataclass
class ClassifiedSignal:
    symbol: str
    name: str
    category: str      # alpha_trend, alpha_whale, risk_distribution, anomaly_extreme
    sub_type: str      # WASH_COMPLETE, ACCUMULATION_STABLE, etc.
    score: float       # ç½®ä¿¡åº¦ 0-1
    mcap_tag: str      # å¸‚å€¼æ ‡ç­¾
    data: dict         # åŸå§‹æ•°æ®
    reason: str        # ä¿¡å·åŸå› 
```

### 7.3 ConfidenceEngine
ç½®ä¿¡åº¦è®¡ç®—å¼•æ“ï¼ŒåŸºäºå¸‚å€¼åˆ†å±‚å’Œæ¢æ‰‹ç‡å¥åº·åº¦è¿›è¡ŒåŠ æƒè¯„åˆ†ã€‚

## 8. ä½¿ç”¨æ–¹å¼

```bash
# è¿è¡Œç›‘æ§
python src/utils/volume_monitor.py

# è°ƒè¯•æ¨¡å¼ï¼ˆä¸å‘é€æ¶ˆæ¯ï¼‰
python src/utils/volume_monitor.py --debug

# è‡ªå®šä¹‰é˜ˆå€¼
python src/utils/volume_monitor.py --threshold 60
```
